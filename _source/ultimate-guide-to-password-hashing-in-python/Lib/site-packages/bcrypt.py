from browser import window

# Assumes that this has already been included: https://github.com/dcodeIO/bcrypt.js/
_bcrypt = window.dcodeIO.bcrypt

def gensalt(log_rounds=12):
    return bytes(_bcrypt.genSaltSync(log_rounds), "utf-8")


def hashpw(password, salt):
    return bytes(_bcrypt.hashSync(password.decode("utf-8"), salt.decode("utf-8")), "utf-8")
